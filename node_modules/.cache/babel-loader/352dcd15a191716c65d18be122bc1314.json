{"ast":null,"code":"import _regeneratorRuntime from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import{setSearchResults,toggleUpvote,toggleDownvote,loadSearchPosts}from'../reducers/searchReducer';import{notify}from'../reducers/notificationReducer';import PostCard from'./PostCard';import LoadMoreButton from'./LoadMoreButton';import LoadingSpinner from'./LoadingSpinner';import getErrorMsg from'../utils/getErrorMsg';import{Container,Paper,Typography}from'@material-ui/core';import{useSearchPageStyles}from'../styles/muiStyles';import SearchIcon from'@material-ui/icons/Search';import SentimentVeryDissatisfiedIcon from'@material-ui/icons/SentimentVeryDissatisfied';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SearchResults=function SearchResults(){var classes=useSearchPageStyles();var _useParams=useParams(),query=_useParams.query;var dispatch=useDispatch();var searchResults=useSelector(function(state){return state.search;});var _useState=useState(1),_useState2=_slicedToArray(_useState,2),page=_useState2[0],setPage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loadingMore=_useState4[0],setLoadingMore=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),pageLoading=_useState6[0],setPageLoading=_useState6[1];useEffect(function(){var getSearchResults=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setPageLoading(true);_context.next=4;return dispatch(setSearchResults(query));case 4:setPageLoading(false);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);dispatch(notify(getErrorMsg(_context.t0),'error'));case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function getSearchResults(){return _ref.apply(this,arguments);};}();getSearchResults();setPage(1);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[query]);if(!searchResults||pageLoading){return/*#__PURE__*/_jsx(Container,{disableGutters:true,children:/*#__PURE__*/_jsx(Paper,{variant:\"outlined\",className:classes.mainPaper,children:/*#__PURE__*/_jsx(LoadingSpinner,{text:'Searching for matches...'})})});}var handleLoadPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setLoadingMore(true);_context2.next=4;return dispatch(loadSearchPosts(query,page+1));case 4:setPage(function(prevState){return prevState+1;});setLoadingMore(false);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);dispatch(notify(getErrorMsg(_context2.t0),'error'));case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function handleLoadPosts(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Container,{disableGutters:true,children:/*#__PURE__*/_jsxs(Paper,{variant:\"outlined\",className:classes.mainPaper,children:[/*#__PURE__*/_jsx(Paper,{variant:\"outlined\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",color:\"secondary\",className:classes.infoPaper,children:[/*#__PURE__*/_jsx(SearchIcon,{fontSize:\"large\",style:{marginRight:'7px'}}),\"Showing search results for \\\"\",query,\"\\\"\"]})}),searchResults.results.length!==0?searchResults.results.map(function(s){return/*#__PURE__*/_jsx(PostCard,{post:s,toggleUpvote:toggleUpvote,toggleDownvote:toggleDownvote},s.id);}):/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",className:classes.noResults,children:[/*#__PURE__*/_jsx(SentimentVeryDissatisfiedIcon,{className:classes.sorryIcon,color:\"primary\"}),\"Sorry, there were no post results for \\\"\",query,\"\\\"\"]}),'next'in searchResults&&/*#__PURE__*/_jsx(LoadMoreButton,{handleLoadPosts:handleLoadPosts,loading:loadingMore})]})});};export default SearchResults;","map":{"version":3,"sources":["/home/thaddydore/Desktop/reddish-clone/client/src/components/SearchResults.js"],"names":["React","useEffect","useState","useParams","useDispatch","useSelector","setSearchResults","toggleUpvote","toggleDownvote","loadSearchPosts","notify","PostCard","LoadMoreButton","LoadingSpinner","getErrorMsg","Container","Paper","Typography","useSearchPageStyles","SearchIcon","SentimentVeryDissatisfiedIcon","SearchResults","classes","query","dispatch","searchResults","state","search","page","setPage","loadingMore","setLoadingMore","pageLoading","setPageLoading","getSearchResults","mainPaper","handleLoadPosts","prevState","infoPaper","marginRight","results","length","map","s","id","noResults","sorryIcon"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  setSearchResults,\n  toggleUpvote,\n  toggleDownvote,\n  loadSearchPosts,\n} from '../reducers/searchReducer';\nimport { notify } from '../reducers/notificationReducer';\nimport PostCard from './PostCard';\nimport LoadMoreButton from './LoadMoreButton';\nimport LoadingSpinner from './LoadingSpinner';\nimport getErrorMsg from '../utils/getErrorMsg';\n\nimport { Container, Paper, Typography } from '@material-ui/core';\nimport { useSearchPageStyles } from '../styles/muiStyles';\nimport SearchIcon from '@material-ui/icons/Search';\nimport SentimentVeryDissatisfiedIcon from '@material-ui/icons/SentimentVeryDissatisfied';\n\nconst SearchResults = () => {\n  const classes = useSearchPageStyles();\n  const { query } = useParams();\n  const dispatch = useDispatch();\n  const searchResults = useSelector((state) => state.search);\n  const [page, setPage] = useState(1);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [pageLoading, setPageLoading] = useState(true);\n\n  useEffect(() => {\n    const getSearchResults = async () => {\n      try {\n        setPageLoading(true);\n        await dispatch(setSearchResults(query));\n        setPageLoading(false);\n      } catch (err) {\n        dispatch(notify(getErrorMsg(err), 'error'));\n      }\n    };\n    getSearchResults();\n    setPage(1);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [query]);\n\n  if (!searchResults || pageLoading) {\n    return (\n      <Container disableGutters>\n        <Paper variant=\"outlined\" className={classes.mainPaper}>\n          <LoadingSpinner text={'Searching for matches...'} />\n        </Paper>\n      </Container>\n    );\n  }\n\n  const handleLoadPosts = async () => {\n    try {\n      setLoadingMore(true);\n      await dispatch(loadSearchPosts(query, page + 1));\n      setPage((prevState) => prevState + 1);\n      setLoadingMore(false);\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  return (\n    <Container disableGutters>\n      <Paper variant=\"outlined\" className={classes.mainPaper}>\n        <Paper variant=\"outlined\">\n          <Typography\n            variant=\"h6\"\n            color=\"secondary\"\n            className={classes.infoPaper}\n          >\n            <SearchIcon fontSize=\"large\" style={{ marginRight: '7px' }} />\n            Showing search results for \"{query}\"\n          </Typography>\n        </Paper>\n        {searchResults.results.length !== 0 ? (\n          searchResults.results.map((s) => (\n            <PostCard\n              key={s.id}\n              post={s}\n              toggleUpvote={toggleUpvote}\n              toggleDownvote={toggleDownvote}\n            />\n          ))\n        ) : (\n          <Typography variant=\"h5\" className={classes.noResults}>\n            <SentimentVeryDissatisfiedIcon\n              className={classes.sorryIcon}\n              color=\"primary\"\n            />\n            Sorry, there were no post results for \"{query}\"\n          </Typography>\n        )}\n        {'next' in searchResults && (\n          <LoadMoreButton\n            handleLoadPosts={handleLoadPosts}\n            loading={loadingMore}\n          />\n        )}\n      </Paper>\n    </Container>\n  );\n};\n\nexport default SearchResults;\n"]},"metadata":{},"sourceType":"module"}