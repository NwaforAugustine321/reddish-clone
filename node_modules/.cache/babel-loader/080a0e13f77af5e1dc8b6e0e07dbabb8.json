{"ast":null,"code":"import _regeneratorRuntime from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import authService from'../services/auth';import userService from'../services/user';import storageService from'../utils/localStorage';var userReducer=function userReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case'LOGIN':return action.payload;case'SIGNUP':return action.payload;case'LOGOUT':return null;case'SET_USER':return action.payload;case'SET_AVATAR':return _objectSpread(_objectSpread({},state),action.payload);case'REMOVE_AVATAR':return _objectSpread(_objectSpread({},state),{},{avatar:{exists:false}});default:return state;}};export var loginUser=function loginUser(credentials){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authService.login(credentials);case 2:user=_context.sent;storageService.saveUser(user);authService.setToken(user.token);dispatch({type:'LOGIN',payload:user});case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var signupUser=function signupUser(credentials){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authService.signup(credentials);case 2:user=_context2.sent;storageService.saveUser(user);authService.setToken(user.token);dispatch({type:'SIGNUP',payload:user});case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logoutUser=function logoutUser(){return function(dispatch){storageService.logoutUser();authService.setToken(null);dispatch({type:'LOGOUT'});};};export var setUser=function setUser(){return function(dispatch){var loggedUser=storageService.loadUser();if(loggedUser){authService.setToken(loggedUser.token);dispatch({type:'SET_USER',payload:loggedUser});}};};export var setAvatar=function setAvatar(avatarImage){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var uploadedAvatar,prevUserData;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return userService.uploadAvatar({avatarImage:avatarImage});case 2:uploadedAvatar=_context3.sent;prevUserData=storageService.loadUser();storageService.saveUser(_objectSpread(_objectSpread({},prevUserData),uploadedAvatar));dispatch({type:'SET_AVATAR',payload:uploadedAvatar});case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var deleteAvatar=function deleteAvatar(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var prevUserData;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return userService.removeAvatar();case 2:prevUserData=storageService.loadUser();storageService.saveUser(_objectSpread(_objectSpread({},prevUserData),{},{avatar:{exists:false}}));dispatch({type:'REMOVE_AVATAR'});case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export default userReducer;","map":{"version":3,"sources":["/home/thaddydore/Desktop/reddish-clone/client/src/reducers/userReducer.js"],"names":["authService","userService","storageService","userReducer","state","action","type","payload","avatar","exists","loginUser","credentials","dispatch","login","user","saveUser","setToken","token","signupUser","signup","logoutUser","setUser","loggedUser","loadUser","setAvatar","avatarImage","uploadAvatar","uploadedAvatar","prevUserData","deleteAvatar","removeAvatar"],"mappings":"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","sourcesContent":["import authService from '../services/auth';\nimport userService from '../services/user';\nimport storageService from '../utils/localStorage';\n\nconst userReducer = (state = null, action) => {\n  switch (action.type) {\n    case 'LOGIN':\n      return action.payload;\n    case 'SIGNUP':\n      return action.payload;\n    case 'LOGOUT':\n      return null;\n    case 'SET_USER':\n      return action.payload;\n    case 'SET_AVATAR':\n      return { ...state, ...action.payload };\n    case 'REMOVE_AVATAR':\n      return { ...state, avatar: { exists: false } };\n    default:\n      return state;\n  }\n};\n\nexport const loginUser = (credentials) => {\n  return async (dispatch) => {\n    const user = await authService.login(credentials);\n    storageService.saveUser(user);\n    authService.setToken(user.token);\n\n    dispatch({\n      type: 'LOGIN',\n      payload: user,\n    });\n  };\n};\n\nexport const signupUser = (credentials) => {\n  return async (dispatch) => {\n    const user = await authService.signup(credentials);\n    storageService.saveUser(user);\n    authService.setToken(user.token);\n\n    dispatch({\n      type: 'SIGNUP',\n      payload: user,\n    });\n  };\n};\n\nexport const logoutUser = () => {\n  return (dispatch) => {\n    storageService.logoutUser();\n    authService.setToken(null);\n\n    dispatch({\n      type: 'LOGOUT',\n    });\n  };\n};\n\nexport const setUser = () => {\n  return (dispatch) => {\n    const loggedUser = storageService.loadUser();\n\n    if (loggedUser) {\n      authService.setToken(loggedUser.token);\n\n      dispatch({\n        type: 'SET_USER',\n        payload: loggedUser,\n      });\n    }\n  };\n};\n\nexport const setAvatar = (avatarImage) => {\n  return async (dispatch) => {\n    const uploadedAvatar = await userService.uploadAvatar({ avatarImage });\n    const prevUserData = storageService.loadUser();\n    storageService.saveUser({ ...prevUserData, ...uploadedAvatar });\n\n    dispatch({\n      type: 'SET_AVATAR',\n      payload: uploadedAvatar,\n    });\n  };\n};\n\nexport const deleteAvatar = () => {\n  return async (dispatch) => {\n    await userService.removeAvatar();\n    const prevUserData = storageService.loadUser();\n    storageService.saveUser({ ...prevUserData, avatar: { exists: false } });\n\n    dispatch({\n      type: 'REMOVE_AVATAR',\n    });\n  };\n};\n\nexport default userReducer;\n"]},"metadata":{},"sourceType":"module"}