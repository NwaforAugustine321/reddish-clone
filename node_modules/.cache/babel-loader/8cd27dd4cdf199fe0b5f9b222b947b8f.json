{"ast":null,"code":"import _regeneratorRuntime from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import postService from'../services/posts';var postPageReducer=function postPageReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case'FETCH_POST_COMMENTS':return action.payload;case'CREATE_NEW_POST':return action.payload;case'UPDATE_POST':return action.payload;case'TOGGLE_VOTE':return _objectSpread(_objectSpread({},state),action.payload);case'VOTE_COMMENT':return _objectSpread(_objectSpread({},state),{},{comments:state.comments.map(function(c){return c.id!==action.payload.commentId?c:_objectSpread(_objectSpread({},c),action.payload.data);})});case'VOTE_REPLY':return _objectSpread(_objectSpread({},state),{},{comments:state.comments.map(function(c){return c.id!==action.payload.commentId?c:_objectSpread(_objectSpread({},c),{},{replies:c.replies.map(function(r){return r.id!==action.payload.replyId?r:_objectSpread(_objectSpread({},r),action.payload.data);})});})});case'ADD_COMMENT':return _objectSpread(_objectSpread({},state),{},{comments:[].concat(_toConsumableArray(state.comments),[action.payload])});case'ADD_REPLY':return _objectSpread(_objectSpread({},state),{},{comments:state.comments.map(function(c){return c.id!==action.payload.commentId?c:_objectSpread(_objectSpread({},c),{},{replies:[].concat(_toConsumableArray(c.replies),[action.payload.addedReply])});})});case'EDIT_COMMENT':return _objectSpread(_objectSpread({},state),{},{comments:state.comments.map(function(c){return c.id!==action.payload.commentId?c:_objectSpread(_objectSpread({},c),action.payload.data);})});case'DELETE_COMMENT':return _objectSpread(_objectSpread({},state),{},{comments:state.comments.filter(function(c){return c.id!==action.payload;})});case'EDIT_REPLY':return _objectSpread(_objectSpread({},state),{},{comments:state.comments.map(function(c){return c.id!==action.payload.commentId?c:_objectSpread(_objectSpread({},c),{},{replies:c.replies.map(function(r){return r.id!==action.payload.replyId?r:_objectSpread(_objectSpread({},r),action.payload.data);})});})});case'DELETE_REPLY':return _objectSpread(_objectSpread({},state),{},{comments:state.comments.map(function(c){return c.id!==action.payload.commentId?c:_objectSpread(_objectSpread({},c),{},{replies:c.replies.filter(function(r){return r.id!==action.payload.replyId;})});})});case'SORT_COMMENTS':return _objectSpread(_objectSpread({},state),{},{comments:state.comments.sort(function(a,b){switch(action.payload){case'new':return new Date(b.createdAt)-new Date(a.createdAt);case'upvoted':return b.pointsCount-a.pointsCount;case'downvoted':return a.pointsCount-b.pointsCount;case'replied':return b.replies.length-a.replies.length;default:return new Date(a.createdAt)-new Date(b.createdAt);}})});default:return state;}};export var fetchPostComments=function fetchPostComments(id){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var fetchedPost;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return postService.getPostComments(id);case 2:fetchedPost=_context.sent;dispatch({type:'FETCH_POST_COMMENTS',payload:fetchedPost});case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var createNewPost=function createNewPost(postObject){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var addedPost;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return postService.addNew(postObject);case 2:addedPost=_context2.sent;dispatch({type:'CREATE_NEW_POST',payload:addedPost});return _context2.abrupt(\"return\",addedPost.id);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var updatePost=function updatePost(id,postObject){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var updatedPost;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return postService.editPost(id,postObject);case 2:updatedPost=_context3.sent;dispatch({type:'UPDATE_POST',payload:updatedPost});case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var toggleUpvote=function toggleUpvote(id,upvotedBy,downvotedBy){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var pointsCount;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;if(pointsCount<0){pointsCount=0;}dispatch({type:'TOGGLE_VOTE',payload:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}});_context4.next=5;return postService.upvotePost(id);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var toggleDownvote=function toggleDownvote(id,downvotedBy,upvotedBy){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var pointsCount;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;if(pointsCount<0){pointsCount=0;}dispatch({type:'TOGGLE_VOTE',payload:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}});_context5.next=5;return postService.downvotePost(id);case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5){return _ref5.apply(this,arguments);};}();};export var toggleCommentUpvote=function toggleCommentUpvote(postId,commentId,upvotedBy,downvotedBy){return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){var pointsCount;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;dispatch({type:'VOTE_COMMENT',payload:{commentId:commentId,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context6.next=4;return postService.upvoteComment(postId,commentId);case 4:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x6){return _ref6.apply(this,arguments);};}();};export var toggleCommentDownvote=function toggleCommentDownvote(postId,commentId,downvotedBy,upvotedBy){return/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dispatch){var pointsCount;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;dispatch({type:'VOTE_COMMENT',payload:{commentId:commentId,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context7.next=4;return postService.downvoteComment(postId,commentId);case 4:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x7){return _ref7.apply(this,arguments);};}();};export var toggleReplyUpvote=function toggleReplyUpvote(postId,commentId,replyId,upvotedBy,downvotedBy){return/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(dispatch){var pointsCount;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;dispatch({type:'VOTE_REPLY',payload:{commentId:commentId,replyId:replyId,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context8.next=4;return postService.upvoteReply(postId,commentId,replyId);case 4:case\"end\":return _context8.stop();}}},_callee8);}));return function(_x8){return _ref8.apply(this,arguments);};}();};export var toggleReplyDownvote=function toggleReplyDownvote(postId,commentId,replyId,downvotedBy,upvotedBy){return/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(dispatch){var pointsCount;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;dispatch({type:'VOTE_REPLY',payload:{commentId:commentId,replyId:replyId,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context9.next=4;return postService.downvoteReply(postId,commentId,replyId);case 4:case\"end\":return _context9.stop();}}},_callee9);}));return function(_x9){return _ref9.apply(this,arguments);};}();};export var addComment=function addComment(postId,comment){return/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(dispatch){var addedComment;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return postService.postComment(postId,{comment:comment});case 2:addedComment=_context10.sent;dispatch({type:'ADD_COMMENT',payload:addedComment});case 4:case\"end\":return _context10.stop();}}},_callee10);}));return function(_x10){return _ref10.apply(this,arguments);};}();};export var addReply=function addReply(postId,commentId,reply){return/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(dispatch){var addedReply;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return postService.postReply(postId,commentId,{reply:reply});case 2:addedReply=_context11.sent;dispatch({type:'ADD_REPLY',payload:{commentId:commentId,addedReply:addedReply}});case 4:case\"end\":return _context11.stop();}}},_callee11);}));return function(_x11){return _ref11.apply(this,arguments);};}();};export var editComment=function editComment(postId,commentId,comment){return/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(dispatch){var updatedAt;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return postService.updateComment(postId,commentId,{comment:comment});case 2:updatedAt=Date.now();dispatch({type:'EDIT_COMMENT',payload:{commentId:commentId,data:{updatedAt:updatedAt,commentBody:comment}}});case 4:case\"end\":return _context12.stop();}}},_callee12);}));return function(_x12){return _ref12.apply(this,arguments);};}();};export var deleteComment=function deleteComment(postId,commentId){return/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(dispatch){return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return postService.removeComment(postId,commentId);case 2:dispatch({type:'DELETE_COMMENT',payload:commentId});case 3:case\"end\":return _context13.stop();}}},_callee13);}));return function(_x13){return _ref13.apply(this,arguments);};}();};export var editReply=function editReply(postId,commentId,replyId,reply){return/*#__PURE__*/function(){var _ref14=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee14(dispatch){var updatedAt;return _regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return postService.updateReply(postId,commentId,replyId,{reply:reply});case 2:updatedAt=Date.now();dispatch({type:'EDIT_REPLY',payload:{commentId:commentId,replyId:replyId,data:{updatedAt:updatedAt,replyBody:reply}}});case 4:case\"end\":return _context14.stop();}}},_callee14);}));return function(_x14){return _ref14.apply(this,arguments);};}();};export var deleteReply=function deleteReply(postId,commentId,replyId){return/*#__PURE__*/function(){var _ref15=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee15(dispatch){return _regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:_context15.next=2;return postService.removeReply(postId,commentId,replyId);case 2:dispatch({type:'DELETE_REPLY',payload:{commentId:commentId,replyId:replyId}});case 3:case\"end\":return _context15.stop();}}},_callee15);}));return function(_x15){return _ref15.apply(this,arguments);};}();};export var sortComments=function sortComments(sortBy){return function(dispatch){dispatch({type:'SORT_COMMENTS',payload:sortBy});};};export default postPageReducer;","map":{"version":3,"sources":["/home/thaddydore/Desktop/reddish-clone/client/src/reducers/postCommentsReducer.js"],"names":["postService","postPageReducer","state","action","type","payload","comments","map","c","id","commentId","data","replies","r","replyId","addedReply","filter","sort","a","b","Date","createdAt","pointsCount","length","fetchPostComments","dispatch","getPostComments","fetchedPost","createNewPost","postObject","addNew","addedPost","updatePost","editPost","updatedPost","toggleUpvote","upvotedBy","downvotedBy","upvotePost","toggleDownvote","downvotePost","toggleCommentUpvote","postId","upvoteComment","toggleCommentDownvote","downvoteComment","toggleReplyUpvote","upvoteReply","toggleReplyDownvote","downvoteReply","addComment","comment","postComment","addedComment","addReply","reply","postReply","editComment","updateComment","updatedAt","now","commentBody","deleteComment","removeComment","editReply","updateReply","replyBody","deleteReply","removeReply","sortComments","sortBy"],"mappings":"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","sourcesContent":["import postService from '../services/posts';\n\nconst postPageReducer = (state = null, action) => {\n  switch (action.type) {\n    case 'FETCH_POST_COMMENTS':\n      return action.payload;\n    case 'CREATE_NEW_POST':\n      return action.payload;\n    case 'UPDATE_POST':\n      return action.payload;\n    case 'TOGGLE_VOTE':\n      return { ...state, ...action.payload };\n    case 'VOTE_COMMENT':\n      return {\n        ...state,\n        comments: state.comments.map((c) =>\n          c.id !== action.payload.commentId\n            ? c\n            : { ...c, ...action.payload.data }\n        ),\n      };\n    case 'VOTE_REPLY':\n      return {\n        ...state,\n        comments: state.comments.map((c) =>\n          c.id !== action.payload.commentId\n            ? c\n            : {\n                ...c,\n                replies: c.replies.map((r) =>\n                  r.id !== action.payload.replyId\n                    ? r\n                    : { ...r, ...action.payload.data }\n                ),\n              }\n        ),\n      };\n    case 'ADD_COMMENT':\n      return {\n        ...state,\n        comments: [...state.comments, action.payload],\n      };\n    case 'ADD_REPLY':\n      return {\n        ...state,\n        comments: state.comments.map((c) =>\n          c.id !== action.payload.commentId\n            ? c\n            : { ...c, replies: [...c.replies, action.payload.addedReply] }\n        ),\n      };\n    case 'EDIT_COMMENT':\n      return {\n        ...state,\n        comments: state.comments.map((c) =>\n          c.id !== action.payload.commentId\n            ? c\n            : { ...c, ...action.payload.data }\n        ),\n      };\n    case 'DELETE_COMMENT':\n      return {\n        ...state,\n        comments: state.comments.filter((c) => c.id !== action.payload),\n      };\n    case 'EDIT_REPLY':\n      return {\n        ...state,\n        comments: state.comments.map((c) =>\n          c.id !== action.payload.commentId\n            ? c\n            : {\n                ...c,\n                replies: c.replies.map((r) =>\n                  r.id !== action.payload.replyId\n                    ? r\n                    : { ...r, ...action.payload.data }\n                ),\n              }\n        ),\n      };\n    case 'DELETE_REPLY':\n      return {\n        ...state,\n        comments: state.comments.map((c) =>\n          c.id !== action.payload.commentId\n            ? c\n            : {\n                ...c,\n                replies: c.replies.filter(\n                  (r) => r.id !== action.payload.replyId\n                ),\n              }\n        ),\n      };\n    case 'SORT_COMMENTS':\n      return {\n        ...state,\n        comments: state.comments.sort((a, b) => {\n          switch (action.payload) {\n            case 'new':\n              return new Date(b.createdAt) - new Date(a.createdAt);\n            case 'upvoted':\n              return b.pointsCount - a.pointsCount;\n            case 'downvoted':\n              return a.pointsCount - b.pointsCount;\n            case 'replied':\n              return b.replies.length - a.replies.length;\n            default:\n              return new Date(a.createdAt) - new Date(b.createdAt);\n          }\n        }),\n      };\n    default:\n      return state;\n  }\n};\n\nexport const fetchPostComments = (id) => {\n  return async (dispatch) => {\n    const fetchedPost = await postService.getPostComments(id);\n\n    dispatch({\n      type: 'FETCH_POST_COMMENTS',\n      payload: fetchedPost,\n    });\n  };\n};\n\nexport const createNewPost = (postObject) => {\n  return async (dispatch) => {\n    const addedPost = await postService.addNew(postObject);\n\n    dispatch({\n      type: 'CREATE_NEW_POST',\n      payload: addedPost,\n    });\n\n    return addedPost.id;\n  };\n};\n\nexport const updatePost = (id, postObject) => {\n  return async (dispatch) => {\n    const updatedPost = await postService.editPost(id, postObject);\n\n    dispatch({\n      type: 'UPDATE_POST',\n      payload: updatedPost,\n    });\n  };\n};\n\nexport const toggleUpvote = (id, upvotedBy, downvotedBy) => {\n  return async (dispatch) => {\n    let pointsCount = upvotedBy.length - downvotedBy.length;\n    if (pointsCount < 0) {\n      pointsCount = 0;\n    }\n\n    dispatch({\n      type: 'TOGGLE_VOTE',\n      payload: { upvotedBy, pointsCount, downvotedBy },\n    });\n\n    await postService.upvotePost(id);\n  };\n};\n\nexport const toggleDownvote = (id, downvotedBy, upvotedBy) => {\n  return async (dispatch) => {\n    let pointsCount = upvotedBy.length - downvotedBy.length;\n    if (pointsCount < 0) {\n      pointsCount = 0;\n    }\n\n    dispatch({\n      type: 'TOGGLE_VOTE',\n      payload: { upvotedBy, pointsCount, downvotedBy },\n    });\n\n    await postService.downvotePost(id);\n  };\n};\n\nexport const toggleCommentUpvote = (\n  postId,\n  commentId,\n  upvotedBy,\n  downvotedBy\n) => {\n  return async (dispatch) => {\n    const pointsCount = upvotedBy.length - downvotedBy.length;\n\n    dispatch({\n      type: 'VOTE_COMMENT',\n      payload: { commentId, data: { upvotedBy, pointsCount, downvotedBy } },\n    });\n\n    await postService.upvoteComment(postId, commentId);\n  };\n};\n\nexport const toggleCommentDownvote = (\n  postId,\n  commentId,\n  downvotedBy,\n  upvotedBy\n) => {\n  return async (dispatch) => {\n    const pointsCount = upvotedBy.length - downvotedBy.length;\n\n    dispatch({\n      type: 'VOTE_COMMENT',\n      payload: { commentId, data: { upvotedBy, pointsCount, downvotedBy } },\n    });\n\n    await postService.downvoteComment(postId, commentId);\n  };\n};\n\nexport const toggleReplyUpvote = (\n  postId,\n  commentId,\n  replyId,\n  upvotedBy,\n  downvotedBy\n) => {\n  return async (dispatch) => {\n    const pointsCount = upvotedBy.length - downvotedBy.length;\n\n    dispatch({\n      type: 'VOTE_REPLY',\n      payload: {\n        commentId,\n        replyId,\n        data: { upvotedBy, pointsCount, downvotedBy },\n      },\n    });\n\n    await postService.upvoteReply(postId, commentId, replyId);\n  };\n};\n\nexport const toggleReplyDownvote = (\n  postId,\n  commentId,\n  replyId,\n  downvotedBy,\n  upvotedBy\n) => {\n  return async (dispatch) => {\n    const pointsCount = upvotedBy.length - downvotedBy.length;\n\n    dispatch({\n      type: 'VOTE_REPLY',\n      payload: {\n        commentId,\n        replyId,\n        data: { upvotedBy, pointsCount, downvotedBy },\n      },\n    });\n\n    await postService.downvoteReply(postId, commentId, replyId);\n  };\n};\n\nexport const addComment = (postId, comment) => {\n  return async (dispatch) => {\n    const addedComment = await postService.postComment(postId, { comment });\n\n    dispatch({\n      type: 'ADD_COMMENT',\n      payload: addedComment,\n    });\n  };\n};\n\nexport const addReply = (postId, commentId, reply) => {\n  return async (dispatch) => {\n    const addedReply = await postService.postReply(postId, commentId, {\n      reply,\n    });\n\n    dispatch({\n      type: 'ADD_REPLY',\n      payload: { commentId, addedReply },\n    });\n  };\n};\n\nexport const editComment = (postId, commentId, comment) => {\n  return async (dispatch) => {\n    await postService.updateComment(postId, commentId, { comment });\n    const updatedAt = Date.now();\n\n    dispatch({\n      type: 'EDIT_COMMENT',\n      payload: { commentId, data: { updatedAt, commentBody: comment } },\n    });\n  };\n};\n\nexport const deleteComment = (postId, commentId) => {\n  return async (dispatch) => {\n    await postService.removeComment(postId, commentId);\n\n    dispatch({\n      type: 'DELETE_COMMENT',\n      payload: commentId,\n    });\n  };\n};\n\nexport const editReply = (postId, commentId, replyId, reply) => {\n  return async (dispatch) => {\n    await postService.updateReply(postId, commentId, replyId, { reply });\n    const updatedAt = Date.now();\n\n    dispatch({\n      type: 'EDIT_REPLY',\n      payload: { commentId, replyId, data: { updatedAt, replyBody: reply } },\n    });\n  };\n};\n\nexport const deleteReply = (postId, commentId, replyId) => {\n  return async (dispatch) => {\n    await postService.removeReply(postId, commentId, replyId);\n\n    dispatch({\n      type: 'DELETE_REPLY',\n      payload: { commentId, replyId },\n    });\n  };\n};\n\nexport const sortComments = (sortBy) => {\n  return (dispatch) => {\n    dispatch({\n      type: 'SORT_COMMENTS',\n      payload: sortBy,\n    });\n  };\n};\n\nexport default postPageReducer;\n"]},"metadata":{},"sourceType":"module"}