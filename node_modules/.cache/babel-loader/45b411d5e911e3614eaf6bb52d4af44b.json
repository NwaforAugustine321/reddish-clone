{"ast":null,"code":"import _regeneratorRuntime from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{useSelector,useDispatch}from'react-redux';import{setAvatar,deleteAvatar}from'../reducers/userReducer';import{notify}from'../reducers/notificationReducer';import DeleteDialog from'./DeleteDialog';import generateBase64Encode from'../utils/genBase64Encode';import AlertMessage from'./AlertMessage';import getErrorMsg from'../utils/getErrorMsg';import{Button,useMediaQuery,IconButton,Typography}from'@material-ui/core';import{useAvatarFormStyles}from'../styles/muiStyles';import{useTheme}from'@material-ui/core/styles';import PublishIcon from'@material-ui/icons/Publish';import CheckCircleIcon from'@material-ui/icons/CheckCircle';import CancelIcon from'@material-ui/icons/Cancel';import FaceIcon from'@material-ui/icons/Face';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UpdateAvatarForm=function UpdateAvatarForm(_ref){var _user$avatar,_user$avatar2;var closeModal=_ref.closeModal;var classes=useAvatarFormStyles();var theme=useTheme();var isMobile=useMediaQuery(theme.breakpoints.down('xs'));var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state;}),user=_useSelector.user;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),avatarInput=_useState2[0],setAvatarInput=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),fileName=_useState4[0],setFileName=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var handleFileInputChange=function handleFileInputChange(e){var file=e.target.files[0];setFileName(file.name);generateBase64Encode(file,setAvatarInput,true);};var clearfileSelection=function clearfileSelection(){setAvatarInput('');setFileName('');};var handleAvatarUpload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(avatarInput==='')){_context.next=2;break;}return _context.abrupt(\"return\",setError('Select an image file first.'));case 2:_context.prev=2;setIsLoading(true);_context.next=6;return dispatch(setAvatar(avatarInput));case 6:setIsLoading(false);dispatch(notify('Successfully updated the avatar!','success'));setAvatarInput('');setFileName('');closeModal();_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](2);setIsLoading(false);setError(getErrorMsg(_context.t0),'error');case 17:case\"end\":return _context.stop();}}},_callee,null,[[2,13]]);}));return function handleAvatarUpload(){return _ref2.apply(this,arguments);};}();var handleRemoveAvatar=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return dispatch(deleteAvatar());case 3:dispatch(notify('Removed avatar.','success'));_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);setError(getErrorMsg(_context2.t0),'error');case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleRemoveAvatar(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[(user===null||user===void 0?void 0:(_user$avatar=user.avatar)===null||_user$avatar===void 0?void 0:_user$avatar.exists)&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:classes.imagePreview,children:/*#__PURE__*/_jsx(\"img\",{alt:user.username+'-avatar',src:user.avatar.imageLink,width:150})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.currentAvatar,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"secondary\",className:classes.currentAvatarText,children:\"Current Avatar\"}),/*#__PURE__*/_jsx(DeleteDialog,{type:\"avatar\",handleDelete:handleRemoveAvatar})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.imageBtnsWrapper,children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"image-upload\",accept:\"image/*\",hidden:true,onChange:handleFileInputChange}),/*#__PURE__*/_jsx(Button,{component:\"label\",htmlFor:\"image-upload\",variant:\"outlined\",color:\"primary\",fullWidth:true,startIcon:avatarInput?/*#__PURE__*/_jsx(CheckCircleIcon,{}):/*#__PURE__*/_jsx(PublishIcon,{}),className:classes.selectBtn,children:avatarInput?\"\".concat(isMobile?'':'Selected ',\"\\\"\").concat(fileName,\"\\\"\"):\"Select Image\"}),avatarInput&&/*#__PURE__*/_jsx(IconButton,{onClick:clearfileSelection,color:\"secondary\",size:isMobile?'small':'medium',className:classes.clearSelectionBtn,children:/*#__PURE__*/_jsx(CancelIcon,{})})]}),avatarInput&&/*#__PURE__*/_jsx(\"div\",{className:classes.imagePreview,children:/*#__PURE__*/_jsx(\"img\",{alt:fileName,src:avatarInput,width:isMobile?250:350})}),/*#__PURE__*/_jsx(Button,{size:isMobile?'medium':'large',variant:\"contained\",color:\"secondary\",className:classes.submitButton,fullWidth:true,startIcon:/*#__PURE__*/_jsx(FaceIcon,{}),onClick:handleAvatarUpload,disabled:isLoading,children:(user===null||user===void 0?void 0:(_user$avatar2=user.avatar)===null||_user$avatar2===void 0?void 0:_user$avatar2.exists)?isLoading?'Updating':'Update avatar':isLoading?'Adding':'Add avatar'}),/*#__PURE__*/_jsx(AlertMessage,{error:error,severity:\"error\",clearError:function clearError(){return setError(null);}})]});};export default UpdateAvatarForm;","map":{"version":3,"sources":["/home/thaddydore/Desktop/reddish-clone/client/src/components/UpdateAvatarForm.js"],"names":["React","useState","useSelector","useDispatch","setAvatar","deleteAvatar","notify","DeleteDialog","generateBase64Encode","AlertMessage","getErrorMsg","Button","useMediaQuery","IconButton","Typography","useAvatarFormStyles","useTheme","PublishIcon","CheckCircleIcon","CancelIcon","FaceIcon","UpdateAvatarForm","closeModal","classes","theme","isMobile","breakpoints","down","dispatch","state","user","avatarInput","setAvatarInput","fileName","setFileName","isLoading","setIsLoading","error","setError","handleFileInputChange","e","file","target","files","name","clearfileSelection","handleAvatarUpload","handleRemoveAvatar","avatar","exists","imagePreview","username","imageLink","currentAvatar","currentAvatarText","imageBtnsWrapper","selectBtn","clearSelectionBtn","submitButton"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setAvatar, deleteAvatar } from '../reducers/userReducer';\nimport { notify } from '../reducers/notificationReducer';\nimport DeleteDialog from './DeleteDialog';\nimport generateBase64Encode from '../utils/genBase64Encode';\nimport AlertMessage from './AlertMessage';\nimport getErrorMsg from '../utils/getErrorMsg';\n\nimport {\n  Button,\n  useMediaQuery,\n  IconButton,\n  Typography,\n} from '@material-ui/core';\nimport { useAvatarFormStyles } from '../styles/muiStyles';\nimport { useTheme } from '@material-ui/core/styles';\nimport PublishIcon from '@material-ui/icons/Publish';\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\nimport CancelIcon from '@material-ui/icons/Cancel';\nimport FaceIcon from '@material-ui/icons/Face';\n\nconst UpdateAvatarForm = ({ closeModal }) => {\n  const classes = useAvatarFormStyles();\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down('xs'));\n  const dispatch = useDispatch();\n  const { user } = useSelector((state) => state);\n  const [avatarInput, setAvatarInput] = useState('');\n  const [fileName, setFileName] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const handleFileInputChange = (e) => {\n    const file = e.target.files[0];\n    setFileName(file.name);\n    generateBase64Encode(file, setAvatarInput, true);\n  };\n\n  const clearfileSelection = () => {\n    setAvatarInput('');\n    setFileName('');\n  };\n\n  const handleAvatarUpload = async () => {\n    if (avatarInput === '') {\n      return setError('Select an image file first.');\n    }\n\n    try {\n      setIsLoading(true);\n      await dispatch(setAvatar(avatarInput));\n      setIsLoading(false);\n\n      dispatch(notify('Successfully updated the avatar!', 'success'));\n      setAvatarInput('');\n      setFileName('');\n      closeModal();\n    } catch (err) {\n      setIsLoading(false);\n      setError(getErrorMsg(err), 'error');\n    }\n  };\n\n  const handleRemoveAvatar = async () => {\n    try {\n      await dispatch(deleteAvatar());\n      dispatch(notify('Removed avatar.', 'success'));\n    } catch (err) {\n      setError(getErrorMsg(err), 'error');\n    }\n  };\n\n  return (\n    <div>\n      {user?.avatar?.exists && (\n        <div>\n          <div className={classes.imagePreview}>\n            <img\n              alt={user.username + '-avatar'}\n              src={user.avatar.imageLink}\n              width={150}\n            />\n          </div>\n          <div className={classes.currentAvatar}>\n            <Typography\n              variant=\"h6\"\n              color=\"secondary\"\n              className={classes.currentAvatarText}\n            >\n              Current Avatar\n            </Typography>\n            <DeleteDialog type=\"avatar\" handleDelete={handleRemoveAvatar} />\n          </div>\n        </div>\n      )}\n      <div className={classes.imageBtnsWrapper}>\n        <input\n          type=\"file\"\n          id=\"image-upload\"\n          accept=\"image/*\"\n          hidden\n          onChange={handleFileInputChange}\n        />\n        <Button\n          component=\"label\"\n          htmlFor=\"image-upload\"\n          variant=\"outlined\"\n          color=\"primary\"\n          fullWidth\n          startIcon={avatarInput ? <CheckCircleIcon /> : <PublishIcon />}\n          className={classes.selectBtn}\n        >\n          {avatarInput\n            ? `${isMobile ? '' : 'Selected '}\"${fileName}\"`\n            : `Select Image`}\n        </Button>\n        {avatarInput && (\n          <IconButton\n            onClick={clearfileSelection}\n            color=\"secondary\"\n            size={isMobile ? 'small' : 'medium'}\n            className={classes.clearSelectionBtn}\n          >\n            <CancelIcon />\n          </IconButton>\n        )}\n      </div>\n      {avatarInput && (\n        <div className={classes.imagePreview}>\n          <img alt={fileName} src={avatarInput} width={isMobile ? 250 : 350} />\n        </div>\n      )}\n      <Button\n        size={isMobile ? 'medium' : 'large'}\n        variant=\"contained\"\n        color=\"secondary\"\n        className={classes.submitButton}\n        fullWidth\n        startIcon={<FaceIcon />}\n        onClick={handleAvatarUpload}\n        disabled={isLoading}\n      >\n        {user?.avatar?.exists\n          ? isLoading\n            ? 'Updating'\n            : 'Update avatar'\n          : isLoading\n          ? 'Adding'\n          : 'Add avatar'}\n      </Button>\n      <AlertMessage\n        error={error}\n        severity=\"error\"\n        clearError={() => setError(null)}\n      />\n    </div>\n  );\n};\n\nexport default UpdateAvatarForm;\n"]},"metadata":{},"sourceType":"module"}