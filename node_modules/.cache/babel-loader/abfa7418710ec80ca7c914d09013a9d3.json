{"ast":null,"code":"import _regeneratorRuntime from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from'react';import{useSelector,useDispatch}from'react-redux';import{Link as RouterLink}from'react-router-dom';import{UpvoteButton,DownvoteButton}from'./VoteButtons';import CommentsAndButtons from'./CommentAndButtons';import ReplyAndButtons from'./ReplyAndButtons';import{toggleCommentUpvote,toggleCommentDownvote,toggleReplyUpvote,toggleReplyDownvote}from'../reducers/postCommentsReducer';import{notify}from'../reducers/notificationReducer';import TimeAgo from'timeago-react';import getErrorMsg from'../utils/getErrorMsg';import{Typography,Link}from'@material-ui/core';import{usePostCommentsStyles}from'../styles/muiStyles';import ForumIcon from'@material-ui/icons/Forum';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CommentsDisplay=function CommentsDisplay(_ref){var comments=_ref.comments,postId=_ref.postId,isMobile=_ref.isMobile;var classes=usePostCommentsStyles();var dispatch=useDispatch();var user=useSelector(function(state){return state.user;});var handleCommentUpvote=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(commentId){var _comments$find,upvotedBy,downvotedBy,updatedUpvotedBy,_updatedUpvotedBy,updatedDownvotedBy;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_comments$find=comments.find(function(c){return c.id===commentId;}),upvotedBy=_comments$find.upvotedBy,downvotedBy=_comments$find.downvotedBy;try{if(upvotedBy.includes(user.id)){updatedUpvotedBy=upvotedBy.filter(function(u){return u!==user.id;});dispatch(toggleCommentUpvote(postId,commentId,updatedUpvotedBy,downvotedBy));}else{_updatedUpvotedBy=[].concat(_toConsumableArray(upvotedBy),[user.id]);updatedDownvotedBy=downvotedBy.filter(function(d){return d!==user.id;});dispatch(toggleCommentUpvote(postId,commentId,_updatedUpvotedBy,updatedDownvotedBy));}}catch(err){dispatch(notify(getErrorMsg(err),'error'));}case 2:case\"end\":return _context.stop();}}},_callee);}));return function handleCommentUpvote(_x){return _ref2.apply(this,arguments);};}();var handleCommentDownvote=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(commentId){var _comments$find2,upvotedBy,downvotedBy,updatedDownvotedBy,_updatedDownvotedBy,updatedUpvotedBy;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_comments$find2=comments.find(function(c){return c.id===commentId;}),upvotedBy=_comments$find2.upvotedBy,downvotedBy=_comments$find2.downvotedBy;try{if(downvotedBy.includes(user.id)){updatedDownvotedBy=downvotedBy.filter(function(d){return d!==user.id;});dispatch(toggleCommentDownvote(postId,commentId,updatedDownvotedBy,upvotedBy));}else{_updatedDownvotedBy=[].concat(_toConsumableArray(downvotedBy),[user.id]);updatedUpvotedBy=upvotedBy.filter(function(u){return u!==user.id;});dispatch(toggleCommentDownvote(postId,commentId,_updatedDownvotedBy,updatedUpvotedBy));}}catch(err){dispatch(notify(getErrorMsg(err),'error'));}case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function handleCommentDownvote(_x2){return _ref3.apply(this,arguments);};}();var handleReplyUpvote=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(commentId,replyId){var targetComment,_targetComment$replie,upvotedBy,downvotedBy,updatedUpvotedBy,_updatedUpvotedBy2,updatedDownvotedBy;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:targetComment=comments.find(function(c){return c.id===commentId;});_targetComment$replie=targetComment.replies.find(function(r){return r.id===replyId;}),upvotedBy=_targetComment$replie.upvotedBy,downvotedBy=_targetComment$replie.downvotedBy;try{if(upvotedBy.includes(user.id)){updatedUpvotedBy=upvotedBy.filter(function(u){return u!==user.id;});dispatch(toggleReplyUpvote(postId,commentId,replyId,updatedUpvotedBy,downvotedBy));}else{_updatedUpvotedBy2=[].concat(_toConsumableArray(upvotedBy),[user.id]);updatedDownvotedBy=downvotedBy.filter(function(d){return d!==user.id;});dispatch(toggleReplyUpvote(postId,commentId,replyId,_updatedUpvotedBy2,updatedDownvotedBy));}}catch(err){dispatch(notify(getErrorMsg(err),'error'));}case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function handleReplyUpvote(_x3,_x4){return _ref4.apply(this,arguments);};}();var handleReplyDownvote=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(commentId,replyId){var targetComment,_targetComment$replie2,upvotedBy,downvotedBy,updatedDownvotedBy,_updatedDownvotedBy2,updatedUpvotedBy;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:targetComment=comments.find(function(c){return c.id===commentId;});_targetComment$replie2=targetComment.replies.find(function(r){return r.id===replyId;}),upvotedBy=_targetComment$replie2.upvotedBy,downvotedBy=_targetComment$replie2.downvotedBy;try{if(downvotedBy.includes(user.id)){updatedDownvotedBy=downvotedBy.filter(function(d){return d!==user.id;});dispatch(toggleReplyDownvote(postId,commentId,replyId,updatedDownvotedBy,upvotedBy));}else{_updatedDownvotedBy2=[].concat(_toConsumableArray(downvotedBy),[user.id]);updatedUpvotedBy=upvotedBy.filter(function(u){return u!==user.id;});dispatch(toggleReplyDownvote(postId,commentId,replyId,_updatedDownvotedBy2,updatedUpvotedBy));}}catch(err){dispatch(notify(getErrorMsg(err),'error'));}case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function handleReplyDownvote(_x5,_x6){return _ref5.apply(this,arguments);};}();var commentDetails=function commentDetails(by,comment){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",children:[/*#__PURE__*/_jsx(Link,{component:RouterLink,to:\"/u/\".concat(by.username),children:by.username}),\" \".concat(comment.pointsCount,\" \").concat(comment.pointsCount===1?'point':'points',\" \\u2022 \"),/*#__PURE__*/_jsx(TimeAgo,{datetime:new Date(comment.createdAt)}),comment.createdAt!==comment.updatedAt&&/*#__PURE__*/_jsxs(\"em\",{children:[' • edited',\" \",/*#__PURE__*/_jsx(TimeAgo,{datetime:new Date(comment.updatedAt)})]})]})});};return/*#__PURE__*/_jsx(\"div\",{className:classes.commentsContainer,children:comments.length!==0?comments.map(function(c){return/*#__PURE__*/_jsxs(\"div\",{className:classes.wholeComment,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.commentWrapper,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.commentVotesWrapper,children:[/*#__PURE__*/_jsx(UpvoteButton,{user:user,body:c,handleUpvote:function handleUpvote(){return handleCommentUpvote(c.id);}}),/*#__PURE__*/_jsx(DownvoteButton,{user:user,body:c,handleDownvote:function handleDownvote(){return handleCommentDownvote(c.id);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.commentDetails,children:[commentDetails(c.commentedBy,c),/*#__PURE__*/_jsx(CommentsAndButtons,{isMobile:isMobile,comment:c,postId:postId,user:user})]})]}),c.replies.map(function(r){return/*#__PURE__*/_jsxs(\"div\",{className:classes.replyWrapper,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.commentVotesWrapper,children:[/*#__PURE__*/_jsx(UpvoteButton,{user:user,body:r,handleUpvote:function handleUpvote(){return handleReplyUpvote(c.id,r.id);}}),/*#__PURE__*/_jsx(DownvoteButton,{user:user,body:r,handleDownvote:function handleDownvote(){return handleReplyDownvote(c.id,r.id);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.commentDetails,children:[commentDetails(r.repliedBy,r),/*#__PURE__*/_jsx(ReplyAndButtons,{isMobile:isMobile,reply:r,postId:postId,commentId:c.id,user:user})]})]},r.id);})]},c.id);}):/*#__PURE__*/_jsxs(\"div\",{className:classes.noCommentsBanner,children:[/*#__PURE__*/_jsx(ForumIcon,{color:\"primary\",fontSize:\"large\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",color:\"secondary\",children:\"No Comments Yet\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"secondary\",children:\"Be the first to share what you think!\"})]})});};export default CommentsDisplay;","map":{"version":3,"sources":["/home/thaddydore/Desktop/reddish-clone/client/src/components/CommentsDisplay.js"],"names":["React","useSelector","useDispatch","Link","RouterLink","UpvoteButton","DownvoteButton","CommentsAndButtons","ReplyAndButtons","toggleCommentUpvote","toggleCommentDownvote","toggleReplyUpvote","toggleReplyDownvote","notify","TimeAgo","getErrorMsg","Typography","usePostCommentsStyles","ForumIcon","CommentsDisplay","comments","postId","isMobile","classes","dispatch","user","state","handleCommentUpvote","commentId","find","c","id","upvotedBy","downvotedBy","includes","updatedUpvotedBy","filter","u","updatedDownvotedBy","d","err","handleCommentDownvote","handleReplyUpvote","replyId","targetComment","replies","r","handleReplyDownvote","commentDetails","by","comment","username","pointsCount","Date","createdAt","updatedAt","commentsContainer","length","map","wholeComment","commentWrapper","commentVotesWrapper","commentedBy","replyWrapper","repliedBy","noCommentsBanner"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Link as RouterLink } from 'react-router-dom';\nimport { UpvoteButton, DownvoteButton } from './VoteButtons';\nimport CommentsAndButtons from './CommentAndButtons';\nimport ReplyAndButtons from './ReplyAndButtons';\nimport {\n  toggleCommentUpvote,\n  toggleCommentDownvote,\n  toggleReplyUpvote,\n  toggleReplyDownvote,\n} from '../reducers/postCommentsReducer';\nimport { notify } from '../reducers/notificationReducer';\nimport TimeAgo from 'timeago-react';\nimport getErrorMsg from '../utils/getErrorMsg';\n\nimport { Typography, Link } from '@material-ui/core';\nimport { usePostCommentsStyles } from '../styles/muiStyles';\nimport ForumIcon from '@material-ui/icons/Forum';\n\nconst CommentsDisplay = ({ comments, postId, isMobile }) => {\n  const classes = usePostCommentsStyles();\n  const dispatch = useDispatch();\n  const user = useSelector((state) => state.user);\n\n  const handleCommentUpvote = async (commentId) => {\n    const { upvotedBy, downvotedBy } = comments.find((c) => c.id === commentId);\n\n    try {\n      if (upvotedBy.includes(user.id)) {\n        const updatedUpvotedBy = upvotedBy.filter((u) => u !== user.id);\n        dispatch(\n          toggleCommentUpvote(postId, commentId, updatedUpvotedBy, downvotedBy)\n        );\n      } else {\n        const updatedUpvotedBy = [...upvotedBy, user.id];\n        const updatedDownvotedBy = downvotedBy.filter((d) => d !== user.id);\n        dispatch(\n          toggleCommentUpvote(\n            postId,\n            commentId,\n            updatedUpvotedBy,\n            updatedDownvotedBy\n          )\n        );\n      }\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const handleCommentDownvote = async (commentId) => {\n    const { upvotedBy, downvotedBy } = comments.find((c) => c.id === commentId);\n\n    try {\n      if (downvotedBy.includes(user.id)) {\n        const updatedDownvotedBy = downvotedBy.filter((d) => d !== user.id);\n        dispatch(\n          toggleCommentDownvote(\n            postId,\n            commentId,\n            updatedDownvotedBy,\n            upvotedBy\n          )\n        );\n      } else {\n        const updatedDownvotedBy = [...downvotedBy, user.id];\n        const updatedUpvotedBy = upvotedBy.filter((u) => u !== user.id);\n        dispatch(\n          toggleCommentDownvote(\n            postId,\n            commentId,\n            updatedDownvotedBy,\n            updatedUpvotedBy\n          )\n        );\n      }\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const handleReplyUpvote = async (commentId, replyId) => {\n    const targetComment = comments.find((c) => c.id === commentId);\n    const { upvotedBy, downvotedBy } = targetComment.replies.find(\n      (r) => r.id === replyId\n    );\n\n    try {\n      if (upvotedBy.includes(user.id)) {\n        const updatedUpvotedBy = upvotedBy.filter((u) => u !== user.id);\n        dispatch(\n          toggleReplyUpvote(\n            postId,\n            commentId,\n            replyId,\n            updatedUpvotedBy,\n            downvotedBy\n          )\n        );\n      } else {\n        const updatedUpvotedBy = [...upvotedBy, user.id];\n        const updatedDownvotedBy = downvotedBy.filter((d) => d !== user.id);\n        dispatch(\n          toggleReplyUpvote(\n            postId,\n            commentId,\n            replyId,\n            updatedUpvotedBy,\n            updatedDownvotedBy\n          )\n        );\n      }\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const handleReplyDownvote = async (commentId, replyId) => {\n    const targetComment = comments.find((c) => c.id === commentId);\n    const { upvotedBy, downvotedBy } = targetComment.replies.find(\n      (r) => r.id === replyId\n    );\n\n    try {\n      if (downvotedBy.includes(user.id)) {\n        const updatedDownvotedBy = downvotedBy.filter((d) => d !== user.id);\n        dispatch(\n          toggleReplyDownvote(\n            postId,\n            commentId,\n            replyId,\n            updatedDownvotedBy,\n            upvotedBy\n          )\n        );\n      } else {\n        const updatedDownvotedBy = [...downvotedBy, user.id];\n        const updatedUpvotedBy = upvotedBy.filter((u) => u !== user.id);\n        dispatch(\n          toggleReplyDownvote(\n            postId,\n            commentId,\n            replyId,\n            updatedDownvotedBy,\n            updatedUpvotedBy\n          )\n        );\n      }\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const commentDetails = (by, comment) => {\n    return (\n      <>\n        <Typography variant=\"caption\">\n          <Link component={RouterLink} to={`/u/${by.username}`}>\n            {by.username}\n          </Link>\n          {` ${comment.pointsCount} ${\n            comment.pointsCount === 1 ? 'point' : 'points'\n          } • `}\n          <TimeAgo datetime={new Date(comment.createdAt)} />\n          {comment.createdAt !== comment.updatedAt && (\n            <em>\n              {' • edited'} <TimeAgo datetime={new Date(comment.updatedAt)} />\n            </em>\n          )}\n        </Typography>\n      </>\n    );\n  };\n\n  return (\n    <div className={classes.commentsContainer}>\n      {comments.length !== 0 ? (\n        comments.map((c) => (\n          <div key={c.id} className={classes.wholeComment}>\n            <div className={classes.commentWrapper}>\n              <div className={classes.commentVotesWrapper}>\n                <UpvoteButton\n                  user={user}\n                  body={c}\n                  handleUpvote={() => handleCommentUpvote(c.id)}\n                />\n                <DownvoteButton\n                  user={user}\n                  body={c}\n                  handleDownvote={() => handleCommentDownvote(c.id)}\n                />\n              </div>\n              <div className={classes.commentDetails}>\n                {commentDetails(c.commentedBy, c)}\n                <CommentsAndButtons\n                  isMobile={isMobile}\n                  comment={c}\n                  postId={postId}\n                  user={user}\n                />\n              </div>\n            </div>\n            {c.replies.map((r) => (\n              <div key={r.id} className={classes.replyWrapper}>\n                <div className={classes.commentVotesWrapper}>\n                  <UpvoteButton\n                    user={user}\n                    body={r}\n                    handleUpvote={() => handleReplyUpvote(c.id, r.id)}\n                  />\n                  <DownvoteButton\n                    user={user}\n                    body={r}\n                    handleDownvote={() => handleReplyDownvote(c.id, r.id)}\n                  />\n                </div>\n                <div className={classes.commentDetails}>\n                  {commentDetails(r.repliedBy, r)}\n                  <ReplyAndButtons\n                    isMobile={isMobile}\n                    reply={r}\n                    postId={postId}\n                    commentId={c.id}\n                    user={user}\n                  />\n                </div>\n              </div>\n            ))}\n          </div>\n        ))\n      ) : (\n        <div className={classes.noCommentsBanner}>\n          <ForumIcon color=\"primary\" fontSize=\"large\" />\n          <Typography variant=\"h5\" color=\"secondary\">\n            No Comments Yet\n          </Typography>\n          <Typography variant=\"h6\" color=\"secondary\">\n            Be the first to share what you think!\n          </Typography>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CommentsDisplay;\n"]},"metadata":{},"sourceType":"module"}