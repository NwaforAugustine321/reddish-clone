{"ast":null,"code":"import _regeneratorRuntime from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import userService from'../services/user';import postService from'../services/posts';var userPageReducer=function userPageReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case'FETCH_USER':return action.payload;case'TOGGLE_USERPAGE_VOTE':return _objectSpread(_objectSpread({},state),{},{posts:_objectSpread(_objectSpread({},state.posts),{},{results:state.posts.results.map(function(r){return r.id!==action.payload.id?r:_objectSpread(_objectSpread({},r),action.payload.data);})})});case'LOAD_USER_POSTS':return _objectSpread(_objectSpread({},state),{},{posts:_objectSpread(_objectSpread({},action.payload.posts),{},{results:[].concat(_toConsumableArray(state.posts.results),_toConsumableArray(action.payload.posts.results))})});default:return state;}};export var fetchUser=function fetchUser(username){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return userService.getUser(username,5,1);case 2:user=_context.sent;dispatch({type:'FETCH_USER',payload:user});case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var loadUserPosts=function loadUserPosts(username,page){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return userService.getUser(username,5,page);case 2:user=_context2.sent;dispatch({type:'LOAD_USER_POSTS',payload:user});case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var toggleUpvote=function toggleUpvote(id,upvotedBy,downvotedBy){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var pointsCount;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;if(pointsCount<0){pointsCount=0;}dispatch({type:'TOGGLE_USERPAGE_VOTE',payload:{id:id,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context3.next=5;return postService.upvotePost(id);case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var toggleDownvote=function toggleDownvote(id,downvotedBy,upvotedBy){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var pointsCount;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;if(pointsCount<0){pointsCount=0;}dispatch({type:'TOGGLE_USERPAGE_VOTE',payload:{id:id,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context4.next=5;return postService.downvotePost(id);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export default userPageReducer;","map":{"version":3,"sources":["/home/thaddydore/Desktop/reddish-clone/client/src/reducers/userPageReducer.js"],"names":["userService","postService","userPageReducer","state","action","type","payload","posts","results","map","r","id","data","fetchUser","username","dispatch","getUser","user","loadUserPosts","page","toggleUpvote","upvotedBy","downvotedBy","pointsCount","length","upvotePost","toggleDownvote","downvotePost"],"mappings":"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","sourcesContent":["import userService from '../services/user';\nimport postService from '../services/posts';\n\nconst userPageReducer = (state = null, action) => {\n  switch (action.type) {\n    case 'FETCH_USER':\n      return action.payload;\n    case 'TOGGLE_USERPAGE_VOTE':\n      return {\n        ...state,\n        posts: {\n          ...state.posts,\n          results: state.posts.results.map((r) =>\n            r.id !== action.payload.id ? r : { ...r, ...action.payload.data }\n          ),\n        },\n      };\n    case 'LOAD_USER_POSTS':\n      return {\n        ...state,\n        posts: {\n          ...action.payload.posts,\n          results: [...state.posts.results, ...action.payload.posts.results],\n        },\n      };\n    default:\n      return state;\n  }\n};\n\nexport const fetchUser = (username) => {\n  return async (dispatch) => {\n    const user = await userService.getUser(username, 5, 1);\n\n    dispatch({\n      type: 'FETCH_USER',\n      payload: user,\n    });\n  };\n};\n\nexport const loadUserPosts = (username, page) => {\n  return async (dispatch) => {\n    const user = await userService.getUser(username, 5, page);\n\n    dispatch({\n      type: 'LOAD_USER_POSTS',\n      payload: user,\n    });\n  };\n};\n\nexport const toggleUpvote = (id, upvotedBy, downvotedBy) => {\n  return async (dispatch) => {\n    let pointsCount = upvotedBy.length - downvotedBy.length;\n    if (pointsCount < 0) {\n      pointsCount = 0;\n    }\n\n    dispatch({\n      type: 'TOGGLE_USERPAGE_VOTE',\n      payload: { id, data: { upvotedBy, pointsCount, downvotedBy } },\n    });\n\n    await postService.upvotePost(id);\n  };\n};\n\nexport const toggleDownvote = (id, downvotedBy, upvotedBy) => {\n  return async (dispatch) => {\n    let pointsCount = upvotedBy.length - downvotedBy.length;\n    if (pointsCount < 0) {\n      pointsCount = 0;\n    }\n\n    dispatch({\n      type: 'TOGGLE_USERPAGE_VOTE',\n      payload: { id, data: { upvotedBy, pointsCount, downvotedBy } },\n    });\n\n    await postService.downvotePost(id);\n  };\n};\n\nexport default userPageReducer;\n"]},"metadata":{},"sourceType":"module"}