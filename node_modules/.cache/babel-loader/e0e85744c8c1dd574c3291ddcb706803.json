{"ast":null,"code":"import _regeneratorRuntime from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/thaddydore/Desktop/reddish-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{useDispatch}from'react-redux';import{addReply,editComment,deleteComment}from'../reducers/postCommentsReducer';import{notify}from'../reducers/notificationReducer';import DeleteDialog from'./DeleteDialog';import getErrorMsg from'../utils/getErrorMsg';import{TextField,Button,Typography}from'@material-ui/core';import{useCommentAndBtnsStyles}from'../styles/muiStyles';import ReplyIcon from'@material-ui/icons/Reply';import SendIcon from'@material-ui/icons/Send';import EditIcon from'@material-ui/icons/Edit';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CommentAndButtons=function CommentAndButtons(_ref){var isMobile=_ref.isMobile,comment=_ref.comment,postId=_ref.postId,user=_ref.user;var classes=useCommentAndBtnsStyles();var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),replyOpen=_useState2[0],setReplyOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),editOpen=_useState4[0],setEditOpen=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),replyInput=_useState6[0],setReplyInput=_useState6[1];var _useState7=useState(comment.commentBody),_useState8=_slicedToArray(_useState7,2),editInput=_useState8[0],setEditInput=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),submitting=_useState10[0],setSubmitting=_useState10[1];var handlePostReply=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setSubmitting(true);_context.next=4;return dispatch(addReply(postId,comment.id,replyInput));case 4:setSubmitting(false);setReplyOpen(false);setReplyInput('');dispatch(notify(\"Reply submitted!\",'success'));_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);setSubmitting(false);dispatch(notify(getErrorMsg(_context.t0),'error'));case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function handlePostReply(){return _ref2.apply(this,arguments);};}();var handleEditComment=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setSubmitting(true);_context2.next=4;return dispatch(editComment(postId,comment.id,editInput));case 4:setSubmitting(false);setEditOpen(false);dispatch(notify(\"Comment edited!\",'success'));_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);setSubmitting(false);dispatch(notify(getErrorMsg(_context2.t0),'error'));case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return function handleEditComment(){return _ref3.apply(this,arguments);};}();var handleCommentDelete=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return dispatch(deleteComment(postId,comment.id));case 3:dispatch(notify(\"Comment deleted!\",'success'));_context3.next=9;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);dispatch(notify(getErrorMsg(_context3.t0),'error'));case 9:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function handleCommentDelete(){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[!editOpen?/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:comment.commentBody}):/*#__PURE__*/_jsxs(\"div\",{className:classes.inputDiv,children:[/*#__PURE__*/_jsx(TextField,{multiline:true,fullWidth:true,rows:2,rowsMax:Infinity,value:editInput,onChange:function onChange(e){return setEditInput(e.target.value);},variant:\"outlined\",size:isMobile?'small':'medium'}),/*#__PURE__*/_jsxs(\"div\",{className:classes.submitBtns,children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setEditOpen(false);},color:\"primary\",variant:\"outlined\",size:\"small\",className:classes.cancelBtn,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleEditComment,color:\"primary\",variant:\"contained\",startIcon:/*#__PURE__*/_jsx(SendIcon,{}),size:\"small\",disabled:submitting,children:submitting?'Updating':'Update'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.btnBar,children:[user&&/*#__PURE__*/_jsx(Button,{size:\"small\",color:\"inherit\",startIcon:/*#__PURE__*/_jsx(ReplyIcon,{}),className:classes.btnStyle,onClick:function onClick(){return setReplyOpen(function(prevState){return!prevState;});},children:\"Reply\"}),user&&user.id===comment.commentedBy.id&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{size:\"small\",color:\"inherit\",startIcon:/*#__PURE__*/_jsx(EditIcon,{}),className:classes.btnStyle,onClick:function onClick(){return setEditOpen(function(prevState){return!prevState;});},children:\"Edit\"}),/*#__PURE__*/_jsx(DeleteDialog,{type:\"comment\",handleDelete:handleCommentDelete})]})]}),replyOpen&&/*#__PURE__*/_jsxs(\"div\",{className:classes.inputDiv,children:[/*#__PURE__*/_jsx(TextField,{placeholder:\"Reply to \".concat(comment.commentedBy.username,\"'s comment\"),multiline:true,required:true,fullWidth:true,rows:4,rowsMax:Infinity,value:replyInput,onChange:function onChange(e){return setReplyInput(e.target.value);},variant:\"outlined\",size:isMobile?'small':'medium'}),/*#__PURE__*/_jsxs(\"div\",{className:classes.submitBtns,children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setReplyOpen(false);},color:\"primary\",variant:\"outlined\",size:\"small\",className:classes.cancelBtn,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handlePostReply,color:\"primary\",variant:\"contained\",startIcon:/*#__PURE__*/_jsx(SendIcon,{}),size:\"small\",disabled:submitting,children:submitting?'Replying':'Reply'})]})]})]});};export default CommentAndButtons;","map":{"version":3,"sources":["/home/thaddydore/Desktop/reddish-clone/client/src/components/CommentAndButtons.js"],"names":["React","useState","useDispatch","addReply","editComment","deleteComment","notify","DeleteDialog","getErrorMsg","TextField","Button","Typography","useCommentAndBtnsStyles","ReplyIcon","SendIcon","EditIcon","CommentAndButtons","isMobile","comment","postId","user","classes","dispatch","replyOpen","setReplyOpen","editOpen","setEditOpen","replyInput","setReplyInput","commentBody","editInput","setEditInput","submitting","setSubmitting","handlePostReply","id","handleEditComment","handleCommentDelete","inputDiv","Infinity","e","target","value","submitBtns","cancelBtn","btnBar","btnStyle","prevState","commentedBy","username"],"mappings":"yeAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OACEC,QADF,CAEEC,WAFF,CAGEC,aAHF,KAIO,iCAJP,CAKA,OAASC,MAAT,KAAuB,iCAAvB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,CACA,MAAOC,CAAAA,WAAP,KAAwB,sBAAxB,CAEA,OAASC,SAAT,CAAoBC,MAApB,CAA4BC,UAA5B,KAA8C,mBAA9C,CACA,OAASC,uBAAT,KAAwC,qBAAxC,CACA,MAAOC,CAAAA,SAAP,KAAsB,0BAAtB,CACA,MAAOC,CAAAA,QAAP,KAAqB,yBAArB,CACA,MAAOC,CAAAA,QAAP,KAAqB,yBAArB,C,6IAEA,GAAMC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,MAAyC,IAAtCC,CAAAA,QAAsC,MAAtCA,QAAsC,CAA5BC,OAA4B,MAA5BA,OAA4B,CAAnBC,MAAmB,MAAnBA,MAAmB,CAAXC,IAAW,MAAXA,IAAW,CACjE,GAAMC,CAAAA,OAAO,CAAGT,uBAAuB,EAAvC,CACA,GAAMU,CAAAA,QAAQ,CAAGpB,WAAW,EAA5B,CACA,cAAkCD,QAAQ,CAAC,KAAD,CAA1C,wCAAOsB,SAAP,eAAkBC,YAAlB,eACA,eAAgCvB,QAAQ,CAAC,KAAD,CAAxC,yCAAOwB,QAAP,eAAiBC,WAAjB,eACA,eAAoCzB,QAAQ,CAAC,EAAD,CAA5C,yCAAO0B,UAAP,eAAmBC,aAAnB,eACA,eAAkC3B,QAAQ,CAACiB,OAAO,CAACW,WAAT,CAA1C,yCAAOC,SAAP,eAAkBC,YAAlB,eACA,eAAoC9B,QAAQ,CAAC,KAAD,CAA5C,0CAAO+B,UAAP,gBAAmBC,aAAnB,gBAEA,GAAMC,CAAAA,eAAe,2FAAG,mJAEpBD,aAAa,CAAC,IAAD,CAAb,CAFoB,sBAGdX,CAAAA,QAAQ,CAACnB,QAAQ,CAACgB,MAAD,CAASD,OAAO,CAACiB,EAAjB,CAAqBR,UAArB,CAAT,CAHM,QAIpBM,aAAa,CAAC,KAAD,CAAb,CACAT,YAAY,CAAC,KAAD,CAAZ,CACAI,aAAa,CAAC,EAAD,CAAb,CACAN,QAAQ,CAAChB,MAAM,oBAAqB,SAArB,CAAP,CAAR,CAPoB,iFASpB2B,aAAa,CAAC,KAAD,CAAb,CACAX,QAAQ,CAAChB,MAAM,CAACE,WAAW,aAAZ,CAAmB,OAAnB,CAAP,CAAR,CAVoB,qEAAH,kBAAf0B,CAAAA,eAAe,2CAArB,CAcA,GAAME,CAAAA,iBAAiB,2FAAG,yJAEtBH,aAAa,CAAC,IAAD,CAAb,CAFsB,uBAGhBX,CAAAA,QAAQ,CAAClB,WAAW,CAACe,MAAD,CAASD,OAAO,CAACiB,EAAjB,CAAqBL,SAArB,CAAZ,CAHQ,QAItBG,aAAa,CAAC,KAAD,CAAb,CACAP,WAAW,CAAC,KAAD,CAAX,CACAJ,QAAQ,CAAChB,MAAM,mBAAoB,SAApB,CAAP,CAAR,CANsB,mFAQtB2B,aAAa,CAAC,KAAD,CAAb,CACAX,QAAQ,CAAChB,MAAM,CAACE,WAAW,cAAZ,CAAmB,OAAnB,CAAP,CAAR,CATsB,sEAAH,kBAAjB4B,CAAAA,iBAAiB,2CAAvB,CAaA,GAAMC,CAAAA,mBAAmB,2FAAG,gLAElBf,CAAAA,QAAQ,CAACjB,aAAa,CAACc,MAAD,CAASD,OAAO,CAACiB,EAAjB,CAAd,CAFU,QAGxBb,QAAQ,CAAChB,MAAM,oBAAqB,SAArB,CAAP,CAAR,CAHwB,kFAKxBgB,QAAQ,CAAChB,MAAM,CAACE,WAAW,cAAZ,CAAmB,OAAnB,CAAP,CAAR,CALwB,qEAAH,kBAAnB6B,CAAAA,mBAAmB,2CAAzB,CASA,mBACE,uBACG,CAACZ,QAAD,cACC,KAAC,UAAD,EAAY,OAAO,CAAC,OAApB,UAA6BP,OAAO,CAACW,WAArC,EADD,cAGC,aAAK,SAAS,CAAER,OAAO,CAACiB,QAAxB,wBACE,KAAC,SAAD,EACE,SAAS,KADX,CAEE,SAAS,KAFX,CAGE,IAAI,CAAE,CAHR,CAIE,OAAO,CAAEC,QAJX,CAKE,KAAK,CAAET,SALT,CAME,QAAQ,CAAE,kBAACU,CAAD,QAAOT,CAAAA,YAAY,CAACS,CAAC,CAACC,MAAF,CAASC,KAAV,CAAnB,EANZ,CAOE,OAAO,CAAC,UAPV,CAQE,IAAI,CAAEzB,QAAQ,CAAG,OAAH,CAAa,QAR7B,EADF,cAWE,aAAK,SAAS,CAAEI,OAAO,CAACsB,UAAxB,wBACE,KAAC,MAAD,EACE,OAAO,CAAE,yBAAMjB,CAAAA,WAAW,CAAC,KAAD,CAAjB,EADX,CAEE,KAAK,CAAC,SAFR,CAGE,OAAO,CAAC,UAHV,CAIE,IAAI,CAAC,OAJP,CAKE,SAAS,CAAEL,OAAO,CAACuB,SALrB,oBADF,cAUE,KAAC,MAAD,EACE,OAAO,CAAER,iBADX,CAEE,KAAK,CAAC,SAFR,CAGE,OAAO,CAAC,WAHV,CAIE,SAAS,cAAE,KAAC,QAAD,IAJb,CAKE,IAAI,CAAC,OALP,CAME,QAAQ,CAAEJ,UANZ,UAQGA,UAAU,CAAG,UAAH,CAAgB,QAR7B,EAVF,GAXF,GAJJ,cAsCE,aAAK,SAAS,CAAEX,OAAO,CAACwB,MAAxB,WACGzB,IAAI,eACH,KAAC,MAAD,EACE,IAAI,CAAC,OADP,CAEE,KAAK,CAAC,SAFR,CAGE,SAAS,cAAE,KAAC,SAAD,IAHb,CAIE,SAAS,CAAEC,OAAO,CAACyB,QAJrB,CAKE,OAAO,CAAE,yBAAMtB,CAAAA,YAAY,CAAC,SAACuB,SAAD,QAAe,CAACA,SAAhB,EAAD,CAAlB,EALX,mBAFJ,CAYG3B,IAAI,EAAIA,IAAI,CAACe,EAAL,GAAYjB,OAAO,CAAC8B,WAAR,CAAoBb,EAAxC,eACC,wCACE,KAAC,MAAD,EACE,IAAI,CAAC,OADP,CAEE,KAAK,CAAC,SAFR,CAGE,SAAS,cAAE,KAAC,QAAD,IAHb,CAIE,SAAS,CAAEd,OAAO,CAACyB,QAJrB,CAKE,OAAO,CAAE,yBAAMpB,CAAAA,WAAW,CAAC,SAACqB,SAAD,QAAe,CAACA,SAAhB,EAAD,CAAjB,EALX,kBADF,cAUE,KAAC,YAAD,EAAc,IAAI,CAAC,SAAnB,CAA6B,YAAY,CAAEV,mBAA3C,EAVF,GAbJ,GAtCF,CAiEGd,SAAS,eACR,aAAK,SAAS,CAAEF,OAAO,CAACiB,QAAxB,wBACE,KAAC,SAAD,EACE,WAAW,oBAAcpB,OAAO,CAAC8B,WAAR,CAAoBC,QAAlC,cADb,CAEE,SAAS,KAFX,CAGE,QAAQ,KAHV,CAIE,SAAS,KAJX,CAKE,IAAI,CAAE,CALR,CAME,OAAO,CAAEV,QANX,CAOE,KAAK,CAAEZ,UAPT,CAQE,QAAQ,CAAE,kBAACa,CAAD,QAAOZ,CAAAA,aAAa,CAACY,CAAC,CAACC,MAAF,CAASC,KAAV,CAApB,EARZ,CASE,OAAO,CAAC,UATV,CAUE,IAAI,CAAEzB,QAAQ,CAAG,OAAH,CAAa,QAV7B,EADF,cAaE,aAAK,SAAS,CAAEI,OAAO,CAACsB,UAAxB,wBACE,KAAC,MAAD,EACE,OAAO,CAAE,yBAAMnB,CAAAA,YAAY,CAAC,KAAD,CAAlB,EADX,CAEE,KAAK,CAAC,SAFR,CAGE,OAAO,CAAC,UAHV,CAIE,IAAI,CAAC,OAJP,CAKE,SAAS,CAAEH,OAAO,CAACuB,SALrB,oBADF,cAUE,KAAC,MAAD,EACE,OAAO,CAAEV,eADX,CAEE,KAAK,CAAC,SAFR,CAGE,OAAO,CAAC,WAHV,CAIE,SAAS,cAAE,KAAC,QAAD,IAJb,CAKE,IAAI,CAAC,OALP,CAME,QAAQ,CAAEF,UANZ,UAQGA,UAAU,CAAG,UAAH,CAAgB,OAR7B,EAVF,GAbF,GAlEJ,GADF,CAyGD,CAtJD,CAwJA,cAAehB,CAAAA,iBAAf","sourcesContent":["import React, { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport {\n  addReply,\n  editComment,\n  deleteComment,\n} from '../reducers/postCommentsReducer';\nimport { notify } from '../reducers/notificationReducer';\nimport DeleteDialog from './DeleteDialog';\nimport getErrorMsg from '../utils/getErrorMsg';\n\nimport { TextField, Button, Typography } from '@material-ui/core';\nimport { useCommentAndBtnsStyles } from '../styles/muiStyles';\nimport ReplyIcon from '@material-ui/icons/Reply';\nimport SendIcon from '@material-ui/icons/Send';\nimport EditIcon from '@material-ui/icons/Edit';\n\nconst CommentAndButtons = ({ isMobile, comment, postId, user }) => {\n  const classes = useCommentAndBtnsStyles();\n  const dispatch = useDispatch();\n  const [replyOpen, setReplyOpen] = useState(false);\n  const [editOpen, setEditOpen] = useState(false);\n  const [replyInput, setReplyInput] = useState('');\n  const [editInput, setEditInput] = useState(comment.commentBody);\n  const [submitting, setSubmitting] = useState(false);\n\n  const handlePostReply = async () => {\n    try {\n      setSubmitting(true);\n      await dispatch(addReply(postId, comment.id, replyInput));\n      setSubmitting(false);\n      setReplyOpen(false);\n      setReplyInput('');\n      dispatch(notify(`Reply submitted!`, 'success'));\n    } catch (err) {\n      setSubmitting(false);\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const handleEditComment = async () => {\n    try {\n      setSubmitting(true);\n      await dispatch(editComment(postId, comment.id, editInput));\n      setSubmitting(false);\n      setEditOpen(false);\n      dispatch(notify(`Comment edited!`, 'success'));\n    } catch (err) {\n      setSubmitting(false);\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const handleCommentDelete = async () => {\n    try {\n      await dispatch(deleteComment(postId, comment.id));\n      dispatch(notify(`Comment deleted!`, 'success'));\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  return (\n    <div>\n      {!editOpen ? (\n        <Typography variant=\"body2\">{comment.commentBody}</Typography>\n      ) : (\n        <div className={classes.inputDiv}>\n          <TextField\n            multiline\n            fullWidth\n            rows={2}\n            rowsMax={Infinity}\n            value={editInput}\n            onChange={(e) => setEditInput(e.target.value)}\n            variant=\"outlined\"\n            size={isMobile ? 'small' : 'medium'}\n          />\n          <div className={classes.submitBtns}>\n            <Button\n              onClick={() => setEditOpen(false)}\n              color=\"primary\"\n              variant=\"outlined\"\n              size=\"small\"\n              className={classes.cancelBtn}\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleEditComment}\n              color=\"primary\"\n              variant=\"contained\"\n              startIcon={<SendIcon />}\n              size=\"small\"\n              disabled={submitting}\n            >\n              {submitting ? 'Updating' : 'Update'}\n            </Button>\n          </div>\n        </div>\n      )}\n      <div className={classes.btnBar}>\n        {user && (\n          <Button\n            size=\"small\"\n            color=\"inherit\"\n            startIcon={<ReplyIcon />}\n            className={classes.btnStyle}\n            onClick={() => setReplyOpen((prevState) => !prevState)}\n          >\n            Reply\n          </Button>\n        )}\n        {user && user.id === comment.commentedBy.id && (\n          <>\n            <Button\n              size=\"small\"\n              color=\"inherit\"\n              startIcon={<EditIcon />}\n              className={classes.btnStyle}\n              onClick={() => setEditOpen((prevState) => !prevState)}\n            >\n              Edit\n            </Button>\n            <DeleteDialog type=\"comment\" handleDelete={handleCommentDelete} />\n          </>\n        )}\n      </div>\n      {replyOpen && (\n        <div className={classes.inputDiv}>\n          <TextField\n            placeholder={`Reply to ${comment.commentedBy.username}'s comment`}\n            multiline\n            required\n            fullWidth\n            rows={4}\n            rowsMax={Infinity}\n            value={replyInput}\n            onChange={(e) => setReplyInput(e.target.value)}\n            variant=\"outlined\"\n            size={isMobile ? 'small' : 'medium'}\n          />\n          <div className={classes.submitBtns}>\n            <Button\n              onClick={() => setReplyOpen(false)}\n              color=\"primary\"\n              variant=\"outlined\"\n              size=\"small\"\n              className={classes.cancelBtn}\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handlePostReply}\n              color=\"primary\"\n              variant=\"contained\"\n              startIcon={<SendIcon />}\n              size=\"small\"\n              disabled={submitting}\n            >\n              {submitting ? 'Replying' : 'Reply'}\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CommentAndButtons;\n"]},"metadata":{},"sourceType":"module"}